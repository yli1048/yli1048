---
title: "Project 2"
author: "Yanyi Li"
date: "2024-10-10"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(reshape2)
```

### First Data Set

This data set pertains to the shipping expenses of a company and encompasses a wide array of data, including numerous empty columns and values.

```{r}
shipment <- read.csv("https://raw.githubusercontent.com/yli1048/yli1048/refs/heads/607/Shipment.csv", header = TRUE, skip = 2)
head(shipment)
```


```{r}
shipment_1 = shipment[c(1, 2, 3, 4)]
names(shipment_1)[1] <- "Order_Date"
names(shipment_1)[2] <- "Consumer"
names(shipment_1)[3] <- "Corporate"
names(shipment_1)[4] <- "Home_Office"

shipment_1 <- melt(shipment_1, id.vars = c("Order_Date"), variable.name = "Segment", value.name = "Amount")

first_class <- shipment_1[!is.na(shipment_1$Amount),]

print(first_class)
```


#### There is no record of same-day shipping, so I have skipped this step.


```{r}
shipment_3 = shipment[c(1, 8, 9, 10)]
names(shipment_3)[1] <- "Order_Date"
names(shipment_3)[2] <- "Consumer"
names(shipment_3)[3] <- "Corporate"
names(shipment_3)[4] <- "Home_Office"

shipment_3 <- melt(shipment_3, id.vars = c("Order_Date"), variable.name = "Segment", value.name = "Amount")

second_class <- shipment_3[!is.na(shipment_3$Amount),]

print(second_class)
```


```{r}
shipment_4 = shipment[c(1, 11, 12, 13)]
names(shipment_4)[1] <- "Order_Date"
names(shipment_4)[2] <- "Consumer"
names(shipment_4)[3] <- "Corporate"
names(shipment_4)[4] <- "HomeOffice"

shipment_4 <- melt(shipment_4, id.vars = c("Order_Date"), variable.name = "Segment", value.name = "Amount")

standard_class <- shipment_4[!is.na(shipment_4$Amount),]

print(standard_class)
```


### Analysis
The process of organizing the wide shipment data set involves segmenting it by different shipping methods, thereby enhancing its clarity. Furthermore, integrating the data sets and incorporating an additional column to delineate the segments can significantly improve the comprehensibility of the data. It is worth noting that numerous rows and columns contained empty values, particularly in relation to same-day delivery.


### Second Data Set

For the second data set, it was sourced from the DOHMH New York City Restaurant Inspection Results. Due to its size, only selected and organized segments of the data set will be presented.

```{r}
inspection <- read.csv("https://raw.githubusercontent.com/yli1048/yli1048/refs/heads/607/NYC_Restaurant_Inspection_Results.csv", header = TRUE)
```


```{r}
store_info <- inspection[c(1, 2, 7, 8)]
names(store_info)[2] <- "NAME"
head(store_info)
```


```{r}
location <- inspection[c(1, 4, 5, 6, 3, 19, 20)]
location_1 = unite(location, address, c(BUILDING, STREET, ZIPCODE, BORO))
location_new = unite(location_1, coordinates, c(Latitude, Longitude))
head(location_new)
```


```{r}
violations <- inspection[c(1, 9, 10, 11, 12, 13)]
violations = unite(violations, inspection, c(INSPECTION.DATE, ACTION))
violations = unite(violations, violations, c(CRITICAL.FLAG, VIOLATION.CODE, VIOLATION.DESCRIPTION))
head(violations)
```


```{r}
inspection_details <- inspection[c(1, 14, 15, 16, 17, 18)]
inspection_details = unite(inspection_details, score, c(RECORD.DATE, SCORE))
inspection_details = unite(inspection_details, grade, c(GRADE.DATE, GRADE))
inspection_details <- melt(inspection_details, id.vars = c("CAMIS"), variable.name = "record", value.name = "Date_and_value")
head(inspection_details)
```


```{r}
community <- inspection[c(1, 21, 22, 23, 24, 25, 26)]
community <- melt(community, id.vars = c("CAMIS"), variable.name = "community", value.name = "info")
head(community)
```


### Analysis

The extensive data set consists of 27 columns, which can be categorized into smaller datasets based on specific criteria. Additionally, CAMIS functions as a distinct identifier for each store, facilitating its use as a representation of the store in the data frames. Segmenting the wide data set enables easier data retrieval and enhances overall organization.


### Third Data Set

The data set pertains to marriages for both genders and encompasses a wide array of conditions. It can be segmented into distinct categories and data frames, enabling a more systematic and organized presentation of the information.

```{r}
marriages <- read.csv("https://raw.githubusercontent.com/fivethirtyeight/data/refs/heads/master/marriage/both_sexes.csv", header = TRUE)
head(marriages)
```


```{r}
#By age of 25-34
age2534 <- marriages[c(2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21)]
```


```{r}
#By education
edu_2534 <- age2534[c(1, 3, 4, 5, 6, 7)]
names(edu_2534)[2] <- "High_School"
names(edu_2534)[3] <- "Some_College"
names(edu_2534)[4] <- "Bachelor's"
names(edu_2534)[5] <- "No_Graduate"
names(edu_2534)[6] <- "Graduate"

edu_2534 <- melt(edu_2534, id.vars = c("year"), variable.name = "education", value.name = "rate")

edu_2534 <- edu_2534[!is.na(edu_2534$rate),]

head(edu_2534)
```


```{r}
#By race
race_2534 <- age2534[c(1, 8, 9, 10)]
names(race_2534)[2] <- "White"
names(race_2534)[3] <- "Black"
names(race_2534)[4] <- "Hispanic"

race_2534 <- melt(race_2534, id.vars = c("year"), variable.name = "race", value.name = "rate")

head(race_2534)
```


```{r}
#By region
region_2534 <- age2534[c(1, 11, 12, 13, 14, 15, 16)]
names(region_2534)[2] <- "New_England"
names(region_2534)[3] <- "Mid_Atlantic"
names(region_2534)[4] <- "Midwest"
names(region_2534)[5] <- "South"
names(region_2534)[6] <- "Mountain_West"
names(region_2534)[7] <- "Pacific"

region_2534 <- melt(region_2534, id.vars = c("year"), variable.name = "region", value.name = "rate")

head(region_2534)
```


```{r}
#By family income
income_2534 <- age2534[c(1, 17, 18, 19)]
names(income_2534)[2] <- "Low_25%"
names(income_2534)[3] <- "Middle_50%"
names(income_2534)[4] <- "Top_25%"

income_2534 <- melt(income_2534, id.vars = c("year"), variable.name = "income", value.name = "rate")

head(income_2534)
```


```{r}
#By age of 35-44
age3544 <- marriages[c(2, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 32, 33, 34, 35, 36, 37, 38, 39)]
```


```{r}
#By education
edu_3544 <- age3544[c(1, 3, 4, 5, 6, 7)]
names(edu_3544)[2] <- "High_School"
names(edu_3544)[3] <- "Some_College"
names(edu_3544)[4] <- "Bachelor's"
names(edu_3544)[5] <- "No_Graduate"
names(edu_3544)[6] <- "Graduate"

edu_3544 <- melt(edu_3544, id.vars = c("year"), variable.name = "education", value.name = "rate")

edu_3544 <- edu_3544[!is.na(edu_3544$rate),]

head(edu_3544)
```


```{r}
#By race
race_3544 <- age3544[c(1, 8, 9, 10)]
names(race_3544)[2] <- "White"
names(race_3544)[3] <- "Black"
names(race_3544)[4] <- "Hispanic"

race_3544 <- melt(race_3544, id.vars = c("year"), variable.name = "race", value.name = "rate")

head(race_3544)
```


```{r}
#By region
region_3544 <- age3544[c(1, 11, 12, 13, 14, 15, 16)]
names(region_3544)[2] <- "New_England"
names(region_3544)[3] <- "Mid_Atlantic"
names(region_3544)[4] <- "Midwest"
names(region_3544)[5] <- "South"
names(region_3544)[6] <- "Mountain_West"
names(region_3544)[7] <- "Pacific"

region_3544 <- melt(region_3544, id.vars = c("year"), variable.name = "region", value.name = "rate")

head(region_3544)
```


```{r}
#By family income
income_3544 <- age3544[c(1, 17, 18, 19)]
names(income_3544)[2] <- "Low_25%"
names(income_3544)[3] <- "Middle_50%"
names(income_3544)[4] <- "Top_25%"

income_3544 <- melt(income_3544, id.vars = c("year"), variable.name = "income", value.name = "rate")

head(income_3544)
```


```{r}
#By age of 35-44
age4554 <- marriages[c(2, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50)]
```


```{r}
#By education
edu_4554 <- age4554[c(1, 3, 4, 5, 6, 7)]
names(edu_4554)[2] <- "High_School"
names(edu_4554)[3] <- "Some_College"
names(edu_4554)[4] <- "Bachelor's"
names(edu_4554)[5] <- "No_Graduate"
names(edu_4554)[6] <- "Graduate"

edu_4554 <- melt(edu_4554, id.vars = c("year"), variable.name = "education", value.name = "rate")

edu_4554 <- edu_4554[!is.na(edu_4554$rate),]

head(edu_4554)
```


```{r}
#By race
race_4554 <- age4554[c(1, 8, 9, 10)]
names(race_4554)[2] <- "White"
names(race_4554)[3] <- "Black"
names(race_4554)[4] <- "Hispanic"

race_4554 <- melt(race_4554, id.vars = c("year"), variable.name = "race", value.name = "rate")

head(race_4554)
```


```{r}
#By region
region_4554 <- age4554[c(1, 11, 12)]
names(region_4554)[2] <- "New_England"
names(region_4554)[3] <- "Mid_Atlantic"

region_4554 <- melt(region_4554, id.vars = c("year"), variable.name = "region", value.name = "rate")

head(region_4554)
```


### Analysis

The initial dataset comprises a diverse range of data spanning multiple decades and years, encompassing various conditions. For improved manageability and clarity, it is advisable to transform the dataset into a long-format dataframe categorized by relevant criteria.